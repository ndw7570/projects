FROM node
# 이미지 - 로컬시스템 혹은 도커 허브 상의 이미지 이름으로 지정
# 이 노드 이미지는 지금 도커 허브에 있으며,
# 실제로 이 도커 허브 이미지를 기반으로 컨테이너를 처음 실행했을 때
# 이 이미에지가 로컬로 다운로드 및 캐시되었기 때문에 로컬에도 컨테이터가 존재한다.

WORKDIR /app
# 디폴트로 실행한 모든 명령은 컨테이너 파일 시스템의 루트 폴더에서 실행
# /app 에 프로젝트 뿐만 아니라 npm install 도 하고 싶으면 WORKDIR 지정

COPY . /app
# COPY . .
# .   -> 띄우고자 하는 프로젝트의 모든 폴더를 의미
#   . -> 이미지의 내부 경로 (image/ container file system)
# 도커 컨테이너의 루트폴더, 루트엔트리를 사용하지 않고 사용자가 선택 권장
# ./ 도 사용 가능, ./는 도커 컨테이너의 현재 작업 디렉토리를 의미
# COPY . ./app ==> 오류!

RUN npm install

EXPOSE 80
# 컨테이너 내부에만 수신 대기중이기 때문에 로컬머신에서 포트를 탐색 불가
# 포트 노출을 알려야 로컬에서 포트를 찾아갈 수 있음

# RUN node server.js - 이미지가 생성될 때 실행됨
CMD [ "node", "server.js" ]
# 컨테이너가 시작될 때 실행됨
# string 으로 옵션 설정하고, node 명령을 사용하여 server.js 파일을 실행